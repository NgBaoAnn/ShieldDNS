# ShieldDNS - TÃ i Liá»‡u Thiáº¿t Káº¿ Ká»¹ Thuáº­t & Lá»™ TrÃ¬nh PhÃ¡t Triá»ƒn

> **á»¨ng dá»¥ng cháº·n quáº£ng cÃ¡o Android báº±ng DNS/VPN-based Adblock (khÃ´ng root)**

---

## Má»¥c Lá»¥c

1. [Tá»•ng Quan Dá»± Ãn](#1-tá»•ng-quan-dá»±-Ã¡n)
2. [Kiáº¿n TrÃºc Tá»•ng Thá»ƒ Há»‡ Thá»‘ng](#2-kiáº¿n-trÃºc-tá»•ng-thá»ƒ-há»‡-thá»‘ng)
3. [Thiáº¿t Káº¿ Module & Package](#3-thiáº¿t-káº¿-module--package)
4. [PhÃ¢n TÃ­ch Ká»¹ Thuáº­t VPN & DNS](#4-phÃ¢n-tÃ­ch-ká»¹-thuáº­t-vpn--dns)
5. [CÃ¡c TÃ­nh NÄƒng ChÃ­nh](#5-cÃ¡c-tÃ­nh-nÄƒng-chÃ­nh)
6. [Thiáº¿t Káº¿ UI vá»›i Jetpack Compose](#6-thiáº¿t-káº¿-ui-vá»›i-jetpack-compose)
7. [Lá»™ TrÃ¬nh PhÃ¡t Triá»ƒn](#7-lá»™-trÃ¬nh-phÃ¡t-triá»ƒn)
8. [CÃ´ng Nghá»‡ & ThÆ° Viá»‡n](#8-cÃ´ng-nghá»‡--thÆ°-viá»‡n)
9. [Rá»§i Ro Ká»¹ Thuáº­t & HÆ°á»›ng Xá»­ LÃ½](#9-rá»§i-ro-ká»¹-thuáº­t--hÆ°á»›ng-xá»­-lÃ½)
10. [Äá»‹nh HÆ°á»›ng Má»Ÿ Rá»™ng](#10-Ä‘á»‹nh-hÆ°á»›ng-má»Ÿ-rá»™ng)

---

## 1. Tá»•ng Quan Dá»± Ãn

### 1.1 Má»¥c TiÃªu

**ShieldDNS** lÃ  á»©ng dá»¥ng Android cháº·n quáº£ng cÃ¡o hoáº¡t Ä‘á»™ng á»Ÿ má»©c DNS, sá»­ dá»¥ng Android VpnService Ä‘á»ƒ táº¡o VPN cá»¥c bá»™ (local VPN), intercept cÃ¡c DNS request vÃ  cháº·n domain quáº£ng cÃ¡o.

| Má»¥c tiÃªu | MÃ´ táº£ |
|----------|-------|
| **Chá»©c nÄƒng chÃ­nh** | Cháº·n quáº£ng cÃ¡o há»‡ thá»‘ng trÃªn toÃ n bá»™ á»©ng dá»¥ng thÃ´ng qua DNS filtering |
| **KhÃ´ng root** | Hoáº¡t Ä‘á»™ng trÃªn má»i thiáº¿t bá»‹ Android 7.0+ mÃ  khÃ´ng cáº§n root |
| **Báº£o máº­t** | KhÃ´ng giáº£i mÃ£ HTTPS, khÃ´ng thu tháº­p dá»¯ liá»‡u ngÆ°á»i dÃ¹ng |
| **Hiá»‡u suáº¥t** | TiÃªu thá»¥ tá»‘i thiá»ƒu pin vÃ  RAM |

### 1.2 Äá»‘i TÆ°á»£ng NgÆ°á»i DÃ¹ng

- **NgÆ°á»i dÃ¹ng phá»• thÃ´ng**: Muá»‘n tráº£i nghiá»‡m sáº¡ch quáº£ng cÃ¡o trÃªn cÃ¡c á»©ng dá»¥ng
- **Sinh viÃªn/NhÃ  phÃ¡t triá»ƒn**: Há»c táº­p vá» VPN, networking, vÃ  Clean Architecture
- **NgÆ°á»i quan tÃ¢m Ä‘áº¿n quyá»n riÃªng tÆ°**: Cháº·n tracker vÃ  ads analytics

### 1.3 GiÃ¡ Trá»‹ Há»c Thuáº­t / Ká»¹ Thuáº­t

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GIÃ TRá»Š Ká»¸ THUáº¬T                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â–¸ Hiá»ƒu sÃ¢u vá» Android VpnService API                          â”‚
â”‚  â–¸ LÃ m viá»‡c vá»›i raw socket vÃ  TUN interface                    â”‚
â”‚  â–¸ PhÃ¢n tÃ­ch DNS protocol (RFC 1035)                           â”‚
â”‚  â–¸ Thá»±c hÃ nh Clean Architecture + MVVM                         â”‚
â”‚  â–¸ Jetpack Compose state management                            â”‚
â”‚  â–¸ Background service optimization trÃªn Android                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.4 Giá»›i Háº¡n & Pháº¡m Vi

> [!WARNING]
> **Nhá»¯ng gÃ¬ ShieldDNS KHÃ”NG thá»ƒ cháº·n:**
> - **YouTube server-side ads**: Quáº£ng cÃ¡o Ä‘Æ°á»£c serve tá»« cÃ¹ng domain vá»›i video (`googlevideo.com`)
> - **HTTPS-encrypted ads**: Quáº£ng cÃ¡o trong traffic Ä‘Ã£ mÃ£ hÃ³a mÃ  khÃ´ng cÃ³ domain riÃªng
> - **Direct IP ads**: Quáº£ng cÃ¡o sá»­ dá»¥ng IP trá»±c tiáº¿p thay vÃ¬ domain

| Pháº¡m vi | Trong pháº¡m vi | NgoÃ i pháº¡m vi |
|---------|---------------|---------------|
| **Ká»¹ thuáº­t** | DNS filtering, UDP packet manipulation | HTTPS inspection, DPI |
| **PhÃ¡p lÃ½** | Cháº·n domain cÃ´ng khai | Bypass DRM, can thiá»‡p ná»™i dung |
| **Dá»¯ liá»‡u** | Local blocklist | Cloud sync, telemetry |

---

## 2. Kiáº¿n TrÃºc Tá»•ng Thá»ƒ Há»‡ Thá»‘ng

### 2.1 SÆ¡ Äá»“ Kiáº¿n TrÃºc (Text-based)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              SHIELDDNS ARCHITECTURE                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                    PRESENTATION LAYER                            â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚   â”‚  â”‚ HomeScreen   â”‚  â”‚ StatsScreen  â”‚  â”‚ SettingsScreen       â”‚   â”‚    â”‚
â”‚   â”‚  â”‚ (Compose)    â”‚  â”‚ (Compose)    â”‚  â”‚ (Compose)            â”‚   â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚   â”‚         â”‚                 â”‚                      â”‚               â”‚    â”‚
â”‚   â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚    â”‚
â”‚   â”‚                           â–¼                                      â”‚    â”‚
â”‚   â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚    â”‚
â”‚   â”‚               â”‚     MainViewModel     â”‚                          â”‚    â”‚
â”‚   â”‚               â”‚  (StateFlow, Hilt)    â”‚                          â”‚    â”‚
â”‚   â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                               â”‚                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                    DOMAIN LAYER                                   â”‚    â”‚
â”‚   â”‚                           â–¼                                       â”‚    â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚   â”‚   â”‚                    USE CASES                             â”‚    â”‚    â”‚
â”‚   â”‚   â”‚  StartVpnUseCase â”‚ StopVpnUseCase â”‚ GetBlockedStatsUC   â”‚    â”‚    â”‚
â”‚   â”‚   â”‚  UpdateBlocklistUC â”‚ ToggleDomainUC â”‚ GetSettingsUC      â”‚    â”‚    â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚   â”‚                           â”‚                                       â”‚    â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚    â”‚
â”‚   â”‚   â”‚              DOMAIN MODELS                             â”‚      â”‚    â”‚
â”‚   â”‚   â”‚  DnsQuery â”‚ BlockedDomain â”‚ VpnState â”‚ AppFilter       â”‚      â”‚    â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                               â”‚                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                     DATA LAYER                                    â”‚    â”‚
â”‚   â”‚                           â–¼                                       â”‚    â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚   â”‚   â”‚                  REPOSITORIES                            â”‚    â”‚    â”‚
â”‚   â”‚   â”‚  BlocklistRepository â”‚ StatsRepository â”‚ SettingsRepo    â”‚    â”‚    â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚   â”‚                           â”‚                                       â”‚    â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚   â”‚   â”‚  Room DB      â”‚  â”‚  DataStore   â”‚  â”‚  Asset Blocklist   â”‚    â”‚    â”‚
â”‚   â”‚   â”‚  (Stats)      â”‚  â”‚  (Settings)  â”‚  â”‚  (hosts.txt)       â”‚    â”‚    â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                               â”‚                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                    SERVICE LAYER                                  â”‚    â”‚
â”‚   â”‚                           â–¼                                       â”‚    â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚   â”‚   â”‚                   AdblockVpnService                      â”‚    â”‚    â”‚
â”‚   â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚    â”‚
â”‚   â”‚   â”‚  â”‚ TunInterface   â”‚  â”‚ DnsParser   â”‚  â”‚ DomainFilter â”‚  â”‚    â”‚    â”‚
â”‚   â”‚   â”‚  â”‚ (FileDesc)     â”‚  â”‚ (UDP Parse) â”‚  â”‚ (Blocklist)  â”‚  â”‚    â”‚    â”‚
â”‚   â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚    â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Luá»“ng Dá»¯ Liá»‡u Chi Tiáº¿t

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DNS REQUEST FLOW                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  1. USER ACTION                                                              â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                             â”‚
â”‚     â”‚   APP    â”‚ â”€â”€â–¶ Truy cáº­p website/app                                    â”‚
â”‚     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                             â”‚
â”‚          â”‚                                                                   â”‚
â”‚  2. DNS QUERY GENERATED                                                      â”‚
â”‚          â–¼                                                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚     â”‚  OS generates DNS Query          â”‚                                    â”‚
â”‚     â”‚  For: ads.doubleclick.net        â”‚                                    â”‚
â”‚     â”‚  UDP Port 53                     â”‚                                    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                  â”‚                                                           â”‚
â”‚  3. VPN INTERCEPT                                                            â”‚
â”‚          â–¼                                                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚     â”‚  TUN Interface catches packet    â”‚                                    â”‚
â”‚     â”‚  â–¸ Read raw IP packet            â”‚                                    â”‚
â”‚     â”‚  â–¸ Identify as UDP:53            â”‚                                    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                  â”‚                                                           â”‚
â”‚  4. DNS PARSING                                                              â”‚
â”‚          â–¼                                                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚     â”‚  DnsParser extracts:             â”‚                                    â”‚
â”‚     â”‚  â–¸ Transaction ID                â”‚                                    â”‚
â”‚     â”‚  â–¸ Query Domain: ads.double...   â”‚                                    â”‚
â”‚     â”‚  â–¸ Query Type: A (IPv4)          â”‚                                    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                  â”‚                                                           â”‚
â”‚  5. DOMAIN FILTERING                                                         â”‚
â”‚          â–¼                                                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚     â”‚  DomainFilter.check(domain)      â”‚                                    â”‚
â”‚     â”‚  â–¸ Check against HashSet         â”‚                                    â”‚
â”‚     â”‚  â–¸ Result: BLOCKED âŒ             â”‚                                    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                  â”‚                                                           â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚         â–¼               â–¼                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  BLOCKED   â”‚  â”‚    ALLOWED      â”‚                                        â”‚
â”‚  â”‚            â”‚  â”‚                 â”‚                                        â”‚
â”‚  â”‚ Forge DNS  â”‚  â”‚ Forward to      â”‚                                        â”‚
â”‚  â”‚ Response:  â”‚  â”‚ upstream DNS:   â”‚                                        â”‚
â”‚  â”‚ 0.0.0.0    â”‚  â”‚ 8.8.8.8         â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚        â”‚                 â”‚                                                   â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚                 â–¼                                                            â”‚
â”‚  6. RESPONSE TO APP                                                          â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚     â”‚  Write response to TUN           â”‚                                    â”‚
â”‚     â”‚  App receives DNS response       â”‚                                    â”‚
â”‚     â”‚  Blocked: Connection fails       â”‚                                    â”‚
â”‚     â”‚  Allowed: Normal operation       â”‚                                    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 Vai TrÃ² Tá»«ng Layer

| Layer | TrÃ¡ch Nhiá»‡m | Dependencies |
|-------|-------------|--------------|
| **Presentation** | Hiá»ƒn thá»‹ UI, nháº­n input tá»« user, observe ViewModel state | Domain layer (via ViewModel) |
| **Domain** | Chá»©a business logic, use cases, models thuáº§n | KhÃ´ng phá»¥ thuá»™c layer khÃ¡c |
| **Data** | Implement repository interfaces, quáº£n lÃ½ database, settings | Domain interfaces |
| **Service** | VPN lifecycle, DNS parsing, packet processing | Domain models, Data repos |

---

## 3. Thiáº¿t Káº¿ Module & Package

### 3.1 Cáº¥u TrÃºc ThÆ° Má»¥c Chi Tiáº¿t

```
app/src/main/java/com/shielddns/
â”œâ”€â”€ ShieldDnsApp.kt                          # Application class vá»›i Hilt
â”œâ”€â”€ MainActivity.kt                          # Single Activity (Compose)
â”‚
â”œâ”€â”€ domain/                                  # â•â•â• DOMAIN LAYER â•â•â•
â”‚   â”œâ”€â”€ model/                               # Domain entities
â”‚   â”‚   â”œâ”€â”€ DnsQuery.kt                      # DNS query model
â”‚   â”‚   â”œâ”€â”€ BlockedDomain.kt                 # Blocked domain info
â”‚   â”‚   â”œâ”€â”€ VpnState.kt                      # VPN connection state
â”‚   â”‚   â”œâ”€â”€ BlockStats.kt                    # Statistics model
â”‚   â”‚   â””â”€â”€ AppFilterRule.kt                 # Per-app filtering rule
â”‚   â”‚
â”‚   â”œâ”€â”€ repository/                          # Repository interfaces
â”‚   â”‚   â”œâ”€â”€ BlocklistRepository.kt           # Blocklist operations
â”‚   â”‚   â”œâ”€â”€ StatsRepository.kt               # Statistics operations
â”‚   â”‚   â””â”€â”€ SettingsRepository.kt            # App settings
â”‚   â”‚
â”‚   â””â”€â”€ usecase/                             # Use cases
â”‚       â”œâ”€â”€ vpn/
â”‚       â”‚   â”œâ”€â”€ StartVpnUseCase.kt
â”‚       â”‚   â”œâ”€â”€ StopVpnUseCase.kt
â”‚       â”‚   â””â”€â”€ GetVpnStateUseCase.kt
â”‚       â”œâ”€â”€ blocklist/
â”‚       â”‚   â”œâ”€â”€ GetBlocklistUseCase.kt
â”‚       â”‚   â”œâ”€â”€ AddToWhitelistUseCase.kt
â”‚       â”‚   â””â”€â”€ AddToBlacklistUseCase.kt
â”‚       â””â”€â”€ stats/
â”‚           â”œâ”€â”€ GetTodayStatsUseCase.kt
â”‚           â””â”€â”€ RecordBlockedQueryUseCase.kt
â”‚
â”œâ”€â”€ data/                                    # â•â•â• DATA LAYER â•â•â•
â”‚   â”œâ”€â”€ repository/                          # Repository implementations
â”‚   â”‚   â”œâ”€â”€ BlocklistRepositoryImpl.kt
â”‚   â”‚   â”œâ”€â”€ StatsRepositoryImpl.kt
â”‚   â”‚   â””â”€â”€ SettingsRepositoryImpl.kt
â”‚   â”‚
â”‚   â”œâ”€â”€ local/
â”‚   â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”‚   â”œâ”€â”€ AppDatabase.kt               # Room database
â”‚   â”‚   â”‚   â”œâ”€â”€ dao/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BlockedQueryDao.kt
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ CustomRuleDao.kt
â”‚   â”‚   â”‚   â””â”€â”€ entity/
â”‚   â”‚   â”‚       â”œâ”€â”€ BlockedQueryEntity.kt
â”‚   â”‚   â”‚       â””â”€â”€ CustomRuleEntity.kt
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ datastore/
â”‚   â”‚   â”‚   â””â”€â”€ SettingsDataStore.kt         # DataStore preferences
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ blocklist/
â”‚   â”‚       â””â”€â”€ AssetBlocklistLoader.kt      # Load hosts.txt from assets
â”‚   â”‚
â”‚   â””â”€â”€ mapper/                              # Entity â†” Domain mappers
â”‚       â”œâ”€â”€ BlockedQueryMapper.kt
â”‚       â””â”€â”€ CustomRuleMapper.kt
â”‚
â”œâ”€â”€ service/                                 # â•â•â• SERVICE LAYER â•â•â•
â”‚   â”œâ”€â”€ vpn/
â”‚   â”‚   â”œâ”€â”€ AdblockVpnService.kt             # Main VPN service
â”‚   â”‚   â”œâ”€â”€ VpnServiceManager.kt             # Start/stop VPN helper
â”‚   â”‚   â””â”€â”€ TunInterfaceManager.kt           # TUN configuration
â”‚   â”‚
â”‚   â”œâ”€â”€ dns/
â”‚   â”‚   â”œâ”€â”€ DnsPacketParser.kt               # Parse UDP DNS packets
â”‚   â”‚   â”œâ”€â”€ DnsResponseBuilder.kt            # Build DNS responses
â”‚   â”‚   â””â”€â”€ DnsConstants.kt                  # DNS protocol constants
â”‚   â”‚
â”‚   â”œâ”€â”€ filter/
â”‚   â”‚   â”œâ”€â”€ DomainFilter.kt                  # Main filtering engine
â”‚   â”‚   â”œâ”€â”€ BlocklistManager.kt              # Manage multiple blocklists
â”‚   â”‚   â””â”€â”€ PatternMatcher.kt                # Wildcard/regex matching
â”‚   â”‚
â”‚   â””â”€â”€ notification/
â”‚       â””â”€â”€ VpnNotificationManager.kt        # Foreground notification
â”‚
â”œâ”€â”€ presentation/                            # â•â•â• PRESENTATION LAYER â•â•â•
â”‚   â”œâ”€â”€ navigation/
â”‚   â”‚   â””â”€â”€ NavGraph.kt                      # Navigation Compose
â”‚   â”‚
â”‚   â”œâ”€â”€ screen/
â”‚   â”‚   â”œâ”€â”€ home/
â”‚   â”‚   â”‚   â”œâ”€â”€ HomeScreen.kt
â”‚   â”‚   â”‚   â””â”€â”€ HomeViewModel.kt
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ stats/
â”‚   â”‚   â”‚   â”œâ”€â”€ StatsScreen.kt
â”‚   â”‚   â”‚   â””â”€â”€ StatsViewModel.kt
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ blocklist/
â”‚   â”‚   â”‚   â”œâ”€â”€ BlocklistScreen.kt
â”‚   â”‚   â”‚   â””â”€â”€ BlocklistViewModel.kt
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ settings/
â”‚   â”‚       â”œâ”€â”€ SettingsScreen.kt
â”‚   â”‚       â””â”€â”€ SettingsViewModel.kt
â”‚   â”‚
â”‚   â”œâ”€â”€ component/                           # Reusable Compose components
â”‚   â”‚   â”œâ”€â”€ VpnToggleButton.kt
â”‚   â”‚   â”œâ”€â”€ StatsCard.kt
â”‚   â”‚   â”œâ”€â”€ DomainListItem.kt
â”‚   â”‚   â””â”€â”€ StatusIndicator.kt
â”‚   â”‚
â”‚   â””â”€â”€ theme/
â”‚       â”œâ”€â”€ Theme.kt
â”‚       â”œâ”€â”€ Color.kt
â”‚       â””â”€â”€ Type.kt
â”‚
â”œâ”€â”€ di/                                      # â•â•â• DEPENDENCY INJECTION â•â•â•
â”‚   â”œâ”€â”€ AppModule.kt                         # Application-level bindings
â”‚   â”œâ”€â”€ DatabaseModule.kt                    # Room database
â”‚   â”œâ”€â”€ RepositoryModule.kt                  # Repository bindings
â”‚   â””â”€â”€ UseCaseModule.kt                     # Use case bindings
â”‚
â””â”€â”€ util/                                    # â•â•â• UTILITIES â•â•â•
    â”œâ”€â”€ NetworkUtils.kt
    â”œâ”€â”€ ByteBufferUtils.kt
    â””â”€â”€ Constants.kt

app/src/main/assets/
â””â”€â”€ blocklist/
    â””â”€â”€ hosts.txt                            # Default blocklist

app/src/main/res/
â”œâ”€â”€ values/
â”‚   â””â”€â”€ strings.xml
â””â”€â”€ drawable/
    â””â”€â”€ ic_shield.xml
```

### 3.2 TrÃ¡ch Nhiá»‡m CÃ¡c Class ChÃ­nh

#### Service Layer

| Class | TrÃ¡ch Nhiá»‡m |
|-------|-------------|
| `AdblockVpnService` | Extends VpnService, quáº£n lÃ½ VPN lifecycle, xá»­ lÃ½ packet trong coroutine loop |
| `DnsPacketParser` | Parse DNS query tá»« UDP packet, extract domain name theo RFC 1035 |
| `DomainFilter` | Lookup domain trong HashSet blocklist, há»— trá»£ wildcard matching |
| `DnsResponseBuilder` | Táº¡o DNS response vá»›i IP 0.0.0.0 cho blocked domains |

#### Data Layer

| Class | TrÃ¡ch Nhiá»‡m |
|-------|-------------|
| `BlocklistRepositoryImpl` | Load blocklist tá»« assets, merge vá»›i custom rules |
| `StatsRepositoryImpl` | Persist blocked queries vÃ o Room, tÃ­nh toÃ¡n thá»‘ng kÃª |
| `AssetBlocklistLoader` | Parse hosts.txt format thÃ nh Set<String> |

#### Domain Layer

| Class | TrÃ¡ch Nhiá»‡m |
|-------|-------------|
| `StartVpnUseCase` | Validate conditions, trigger VPN start |
| `GetVpnStateUseCase` | Expose VPN state as Flow |
| `RecordBlockedQueryUseCase` | Record blocked query vá»›i timestamp |

---

## 4. PhÃ¢n TÃ­ch Ká»¹ Thuáº­t VPN & DNS

### 4.1 VpnService Hoáº¡t Äá»™ng NhÆ° Tháº¿ NÃ o

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ANDROID VPN SERVICE LIFECYCLE                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  1. PREPARATION                                                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚     â”‚  VpnService.prepare(context)                              â”‚   â”‚
â”‚     â”‚  â–¸ Returns Intent if user approval needed                 â”‚   â”‚
â”‚     â”‚  â–¸ Returns null if already approved                       â”‚   â”‚
â”‚     â”‚  â–¸ Shows system VPN permission dialog                     â”‚   â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  2. CONNECTION SETUP                                                â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚     â”‚  Builder()                                                â”‚   â”‚
â”‚     â”‚    .setSession("ShieldDNS")                               â”‚   â”‚
â”‚     â”‚    .addAddress("10.0.0.1", 32)      // VPN IP             â”‚   â”‚
â”‚     â”‚    .addRoute("0.0.0.0", 0)          // Capture all        â”‚   â”‚
â”‚     â”‚    .addDnsServer("10.0.0.2")        // Fake DNS           â”‚   â”‚
â”‚     â”‚    .setBlocking(true)                                     â”‚   â”‚
â”‚     â”‚    .establish()                     // Returns TUN FD     â”‚   â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  3. PACKET PROCESSING LOOP                                          â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚     â”‚  while (running) {                                        â”‚   â”‚
â”‚     â”‚      val packet = tunInput.read()   // Blocking read      â”‚   â”‚
â”‚     â”‚      if (isDnsQuery(packet)) {                            â”‚   â”‚
â”‚     â”‚          processDns(packet)         // Our logic          â”‚   â”‚
â”‚     â”‚      }                                                    â”‚   â”‚
â”‚     â”‚  }                                                        â”‚   â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  4. CLEANUP                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚     â”‚  onDestroy() {                                            â”‚   â”‚
â”‚     â”‚      tunInterface.close()                                 â”‚   â”‚
â”‚     â”‚      stopForeground()                                     â”‚   â”‚
â”‚     â”‚  }                                                        â”‚   â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 CÃ¡ch Intercept DNS Packet (UDP 53)

```kotlin
// Simplified packet structure
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        IP PACKET                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    IP Header     â”‚               Payload                         â”‚
â”‚   (20 bytes)     â”‚                                               â”‚
â”‚                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â–¸ Version: 4    â”‚  â”‚           UDP DATAGRAM                 â”‚  â”‚
â”‚  â–¸ Protocol: 17  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚    (UDP)         â”‚  â”‚ UDP Header â”‚       UDP Payload          â”‚  â”‚
â”‚  â–¸ Src IP        â”‚  â”‚ (8 bytes)  â”‚                           â”‚  â”‚
â”‚  â–¸ Dst IP        â”‚  â”‚            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚                  â”‚  â”‚ â–¸ Src Port â”‚  â”‚    DNS MESSAGE      â”‚  â”‚  â”‚
â”‚                  â”‚  â”‚ â–¸ Dst Port â”‚  â”‚                     â”‚  â”‚  â”‚
â”‚                  â”‚  â”‚   = 53 â—€â”€â”€ â”‚  â”‚ â–¸ ID: 0x1234       â”‚  â”‚  â”‚
â”‚                  â”‚  â”‚ â–¸ Length   â”‚  â”‚ â–¸ Flags            â”‚  â”‚  â”‚
â”‚                  â”‚  â”‚ â–¸ Checksum â”‚  â”‚ â–¸ Questions        â”‚  â”‚  â”‚
â”‚                  â”‚  â”‚            â”‚  â”‚ â–¸ Domain:          â”‚  â”‚  â”‚
â”‚                  â”‚  â”‚            â”‚  â”‚   ads.google.com   â”‚  â”‚  â”‚
â”‚                  â”‚  â”‚            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

// Detection logic
fun isDnsQuery(packet: ByteArray): Boolean {
    val ipProtocol = packet[9].toInt() and 0xFF  // Protocol field
    if (ipProtocol != 17) return false           // 17 = UDP
    
    val ipHeaderLen = (packet[0].toInt() and 0x0F) * 4
    val dstPort = ((packet[ipHeaderLen + 2].toInt() and 0xFF) shl 8) or
                  (packet[ipHeaderLen + 3].toInt() and 0xFF)
    
    return dstPort == 53  // DNS port
}
```

### 4.3 CÃ¡ch Extract Domain tá»« DNS Query

```
DNS Query Format (RFC 1035):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HEADER (12 bytes)                                               â”‚
â”‚  â”œâ”€â”€ ID (2 bytes):        Transaction ID                        â”‚
â”‚  â”œâ”€â”€ Flags (2 bytes):     QR=0 (query), OPCODE, RD, etc.        â”‚
â”‚  â”œâ”€â”€ QDCOUNT (2 bytes):   Number of questions                   â”‚
â”‚  â”œâ”€â”€ ANCOUNT (2 bytes):   Number of answers (0 for query)       â”‚
â”‚  â”œâ”€â”€ NSCOUNT (2 bytes):   Authority records                     â”‚
â”‚  â””â”€â”€ ARCOUNT (2 bytes):   Additional records                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  QUESTION SECTION                                                â”‚
â”‚  â”œâ”€â”€ QNAME:  [3]www[6]google[3]com[0]                           â”‚
â”‚  â”‚           Length-prefixed labels, null-terminated            â”‚
â”‚  â”œâ”€â”€ QTYPE:  0x0001 (A record = IPv4)                           â”‚
â”‚  â””â”€â”€ QCLASS: 0x0001 (IN = Internet)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

// Parsing QNAME
fun extractDomain(dnsPayload: ByteArray): String {
    var offset = 12  // Skip header
    val labels = mutableListOf<String>()
    
    while (true) {
        val labelLen = dnsPayload[offset].toInt() and 0xFF
        if (labelLen == 0) break
        
        val label = String(dnsPayload, offset + 1, labelLen)
        labels.add(label)
        offset += labelLen + 1
    }
    
    return labels.joinToString(".")  // "www.google.com"
}
```

### 4.4 CÆ¡ Cháº¿ Block Domain

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BLOCKING MECHANISM                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  METHOD 1: Return 0.0.0.0 (Recommended âœ“)                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    DNS Query     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚    App     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶   â”‚ ShieldDNSâ”‚                   â”‚
â”‚  â”‚            â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚          â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    0.0.0.0       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                  â”‚
â”‚  â–¸ Forge valid DNS response                                      â”‚
â”‚  â–¸ Answer: ads.doubleclick.net â†’ 0.0.0.0                        â”‚
â”‚  â–¸ App tries to connect to 0.0.0.0 â†’ fails gracefully           â”‚
â”‚  â–¸ No timeout, instant failure                                   â”‚
â”‚                                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                  â”‚
â”‚  METHOD 2: Drop Packet (Not Recommended âœ—)                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    DNS Query     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚    App     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶   â”‚ ShieldDNSâ”‚                   â”‚
â”‚  â”‚            â”‚      ğŸš«          â”‚ (drops)  â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   No Response    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                  â”‚
â”‚  â–¸ App waits for DNS timeout (5-30 seconds)                     â”‚
â”‚  â–¸ May retry multiple times                                      â”‚
â”‚  â–¸ Poor user experience, slow loading                           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.5 Háº¡n Cháº¿ Ká»¹ Thuáº­t

> [!IMPORTANT]
> **Nhá»¯ng giá»›i háº¡n khÃ´ng thá»ƒ vÆ°á»£t qua báº±ng DNS filtering:**

| Limitation | LÃ½ Do | VÃ­ Dá»¥ |
|------------|-------|-------|
| **Server-side ads** | Quáº£ng cÃ¡o serve tá»« cÃ¹ng domain vá»›i content | YouTube video + ads tá»« `googlevideo.com` |
| **HTTPS traffic** | KhÃ´ng thá»ƒ inspect encrypted payload | In-app purchase prompts over HTTPS |
| **IP-based ads** | KhÃ´ng cÃ³ DNS query Ä‘á»ƒ intercept | Ads served via `203.0.113.1` directly |
| **First-party ads** | Ads tá»« domain chÃ­nh cá»§a app | Facebook ads tá»« `facebook.com` |
| **CDN-served ads** | Shared CDN vá»›i legitimate content | Ads tá»« `cloudfront.net` |

---

## 5. CÃ¡c TÃ­nh NÄƒng ChÃ­nh

### 5.1 Báº­t/Táº¯t VPN Adblock

```kotlin
// User Flow
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [TOGGLE BUTTON]                                                 â”‚
â”‚       â”‚                                                          â”‚
â”‚       â–¼                                                          â”‚
â”‚  HomeViewModel.toggleVpn()                                       â”‚
â”‚       â”‚                                                          â”‚
â”‚       â”œâ”€â”€ isVpnEnabled = false                                   â”‚
â”‚       â”‚       â”‚                                                  â”‚
â”‚       â”‚       â–¼                                                  â”‚
â”‚       â”‚   StartVpnUseCase()                                      â”‚
â”‚       â”‚       â”‚                                                  â”‚
â”‚       â”‚       â”œâ”€â”€ Check VPN permission                           â”‚
â”‚       â”‚       â”œâ”€â”€ Start AdblockVpnService                        â”‚
â”‚       â”‚       â””â”€â”€ Update VpnState â†’ CONNECTING â†’ CONNECTED       â”‚
â”‚       â”‚                                                          â”‚
â”‚       â””â”€â”€ isVpnEnabled = true                                    â”‚
â”‚               â”‚                                                  â”‚
â”‚               â–¼                                                  â”‚
â”‚           StopVpnUseCase()                                       â”‚
â”‚               â”‚                                                  â”‚
â”‚               â”œâ”€â”€ Stop AdblockVpnService                         â”‚
â”‚               â””â”€â”€ Update VpnState â†’ DISCONNECTED                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Cháº·n Quáº£ng CÃ¡o YouTube (DNS-level)

```
YouTube Ads Domains (CÃ³ Thá»ƒ Cháº·n):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â–¸ pagead2.googlesyndication.com
â–¸ ad.doubleclick.net
â–¸ ade.googlesyndication.com
â–¸ googleads.g.doubleclick.net
â–¸ s0.2mdn.net
â–¸ ads.youtube.com
â–¸ youtube.cleverads.vn

YouTube Ads Domains (KHÃ”NG THá»‚ Cháº·n):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â–¸ googlevideo.com (video + ads cÃ¹ng domain)
â–¸ youtube.com (main domain)
â–¸ ytimg.com (thumbnails + ads)
```

### 5.3 Whitelist / Blacklist Domain

```kotlin
// Data Model
data class CustomRule(
    val domain: String,
    val ruleType: RuleType,  // WHITELIST or BLACKLIST
    val createdAt: Long
)

// User can add custom rules
- Whitelist: Allow specific blocked domains
- Blacklist: Block additional domains
```

### 5.4 Focus Mode (Per-App Filtering)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FOCUS MODE                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Chá»‰ cháº·n ads cho cÃ¡c á»©ng dá»¥ng Ä‘Æ°á»£c chá»n                        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â˜‘ YouTube         com.google.android.youtube      ENABLED  â”‚ â”‚
â”‚  â”‚  â˜‘ Chrome          com.android.chrome              ENABLED  â”‚ â”‚
â”‚  â”‚  â˜ Facebook        com.facebook.katana             DISABLED â”‚ â”‚
â”‚  â”‚  â˜‘ Instagram       com.instagram.android           ENABLED  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  Implementation:                                                 â”‚
â”‚  VpnService.Builder()                                            â”‚
â”‚      .addDisallowedApplication("com.facebook.katana")           â”‚
â”‚      // Exclude Facebook from VPN tunnel                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.5 Thá»‘ng KÃª

| Metric | MÃ´ Táº£ |
|--------|-------|
| **Ads Blocked Today** | Sá»‘ lÆ°á»£ng queries bá»‹ cháº·n trong ngÃ y |
| **Total Blocked** | Tá»•ng sá»‘ queries bá»‹ cháº·n all-time |
| **Data Saved** | Æ¯á»›c tÃ­nh data tiáº¿t kiá»‡m (avg ad size Ã— blocked count) |
| **Top Blocked Domains** | Top 10 domains bá»‹ cháº·n nhiá»u nháº¥t |
| **Block Rate** | % queries bá»‹ cháº·n / total queries |

---

## 6. Thiáº¿t Káº¿ UI vá»›i Jetpack Compose

### 6.1 CÃ¡c MÃ n HÃ¬nh ChÃ­nh

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      HOME SCREEN                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    ğŸ›¡ï¸ ShieldDNS                           â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚  â”‚
â”‚  â”‚              â”‚                         â”‚                  â”‚  â”‚
â”‚  â”‚              â”‚    [  POWER BUTTON  ]   â”‚                  â”‚  â”‚
â”‚  â”‚              â”‚      â¬¤ PROTECTED        â”‚                  â”‚  â”‚
â”‚  â”‚              â”‚                         â”‚                  â”‚  â”‚
â”‚  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚  â”‚
â”‚  â”‚  â”‚ 1,234           â”‚  â”‚ 12.5 MB         â”‚                â”‚  â”‚
â”‚  â”‚  â”‚ Ads Blocked     â”‚  â”‚ Data Saved      â”‚                â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”                  â”‚  â”‚
â”‚  â”‚  RECENT BLOCKED DOMAINS                                   â”‚  â”‚
â”‚  â”‚  â–¸ ads.doubleclick.net           2 sec ago               â”‚  â”‚
â”‚  â”‚  â–¸ pagead2.googlesyndic...       5 sec ago               â”‚  â”‚
â”‚  â”‚  â–¸ s0.2mdn.net                   12 sec ago              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚  Home  â”‚  â”‚  Stats â”‚  â”‚  List  â”‚  â”‚ Settingsâ”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      STATS SCREEN                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  BLOCKING STATISTICS                                      â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  Today        This Week      This Month                   â”‚  â”‚
â”‚  â”‚  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ]    [    ]         [    ]                       â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚           ğŸ“Š BLOCKED OVER TIME                      â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚     *                                               â”‚ â”‚  â”‚
â”‚  â”‚  â”‚    * *         *                                    â”‚ â”‚  â”‚
â”‚  â”‚  â”‚   *   *   *   * *                                   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  *     * * * *   *                                  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  6AM   9AM   12PM   3PM   6PM   9PM                 â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  TOP BLOCKED DOMAINS                                      â”‚  â”‚
â”‚  â”‚  1. ads.google.com           45.2%  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘            â”‚  â”‚
â”‚  â”‚  2. doubleclick.net          28.1%  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘            â”‚  â”‚
â”‚  â”‚  3. facebook.ads             15.3%  â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘            â”‚  â”‚
â”‚  â”‚  4. analytics.google.com      8.7%  â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 State Management

```kotlin
// UI State - Immutable data class
data class HomeUiState(
    val vpnState: VpnState = VpnState.DISCONNECTED,
    val adsBlockedToday: Int = 0,
    val dataSaved: Long = 0,
    val recentBlocked: List<BlockedDomain> = emptyList(),
    val isLoading: Boolean = false,
    val error: String? = null
)

// ViewModel
@HiltViewModel
class HomeViewModel @Inject constructor(
    private val getVpnStateUseCase: GetVpnStateUseCase,
    private val startVpnUseCase: StartVpnUseCase,
    private val stopVpnUseCase: StopVpnUseCase,
    private val getTodayStatsUseCase: GetTodayStatsUseCase
) : ViewModel() {

    private val _uiState = MutableStateFlow(HomeUiState())
    val uiState: StateFlow<HomeUiState> = _uiState.asStateFlow()

    init {
        observeVpnState()
        observeStats()
    }

    fun toggleVpn() {
        viewModelScope.launch {
            when (_uiState.value.vpnState) {
                VpnState.CONNECTED -> stopVpnUseCase()
                VpnState.DISCONNECTED -> startVpnUseCase()
                else -> { /* Ignore while transitioning */ }
            }
        }
    }
}

// Composable collects state
@Composable
fun HomeScreen(viewModel: HomeViewModel = hiltViewModel()) {
    val uiState by viewModel.uiState.collectAsStateWithLifecycle()
    
    HomeContent(
        uiState = uiState,
        onToggleVpn = viewModel::toggleVpn
    )
}
```

### 6.3 NguyÃªn Táº¯c UX

| NguyÃªn táº¯c | Implementation |
|------------|----------------|
| **ÄÆ¡n giáº£n** | One-tap toggle, khÃ´ng cáº§n cáº¥u hÃ¬nh phá»©c táº¡p |
| **Minh báº¡ch** | Hiá»ƒn thá»‹ rÃµ VPN status, thá»‘ng kÃª real-time |
| **Pháº£n há»“i tá»©c thÃ¬** | Animation khi báº­t/táº¯t, vibration feedback |
| **ThÃ´ng tin há»¯u Ã­ch** | KhÃ´ng quáº£ng cÃ¡o hiá»‡u quáº£ áº£o, nÃ³i rÃµ giá»›i háº¡n |

---

## 7. Lá»™ TrÃ¬nh PhÃ¡t Triá»ƒn

### Phase 1: Foundation (Tuáº§n 1-2)

| Má»¥c tiÃªu | Setup project, cáº¥u trÃºc cÆ¡ báº£n, VPN skeleton |
|----------|---------------------------------------------|
| **CÃ´ng viá»‡c** | |
| Day 1-2 | Project setup: Gradle, dependencies (Hilt, Compose, Room) |
| Day 3-4 | Package structure theo Clean Architecture |
| Day 5-7 | VpnService skeleton, TUN interface setup |
| Day 8-10 | DNS packet parsing (read-only, log domains) |
| Day 11-14 | Basic UI: Home screen vá»›i toggle button |
| **Káº¿t quáº£** | VPN cÃ³ thá»ƒ báº­t/táº¯t, log táº¥t cáº£ DNS queries ra Logcat |

### Phase 2: Core Blocking (Tuáº§n 3-4)

| Má»¥c tiÃªu | Implement DNS filtering engine |
|----------|-------------------------------|
| **CÃ´ng viá»‡c** | |
| Day 1-3 | Load blocklist tá»« assets (hosts.txt format) |
| Day 4-6 | Domain matching logic vá»›i HashSet lookup |
| Day 7-9 | DNS response builder (forge 0.0.0.0 responses) |
| Day 10-12 | Forward unblocked queries to upstream DNS |
| Day 13-14 | Testing, edge cases handling |
| **Káº¿t quáº£** | Ads Ä‘Æ°á»£c cháº·n thá»±c táº¿, cÃ³ thá»ƒ verify báº±ng browser |

### Phase 3: Statistics & Storage (Tuáº§n 5-6)

| Má»¥c tiÃªu | Persist data, hiá»ƒn thá»‹ thá»‘ng kÃª |
|----------|--------------------------------|
| **CÃ´ng viá»‡c** | |
| Day 1-3 | Room database setup (BlockedQuery entity) |
| Day 4-6 | StatsRepository, calculate metrics |
| Day 7-9 | Stats screen UI vá»›i charts |
| Day 10-12 | DataStore cho settings |
| Day 13-14 | Performance optimization (batch inserts) |
| **Káº¿t quáº£** | Hiá»ƒn thá»‹ sá»‘ ads bá»‹ cháº·n, top domains, data saved |

### Phase 4: Advanced Features (Tuáº§n 7-8)

| Má»¥c tiÃªu | Whitelist/Blacklist, Per-app filtering |
|----------|----------------------------------------|
| **CÃ´ng viá»‡c** | |
| Day 1-3 | Custom rules UI vÃ  storage |
| Day 4-6 | App list, per-app filter toggle |
| Day 7-9 | Multiple blocklist sources |
| Day 10-12 | Settings screen hoÃ n chá»‰nh |
| Day 13-14 | Edge cases, error handling |
| **Káº¿t quáº£** | User cÃ³ thá»ƒ customize blocking behavior |

### Phase 5: Polish & Release (Tuáº§n 9-10)

| Má»¥c tiÃªu | UI polish, testing, documentation |
|----------|-----------------------------------|
| **CÃ´ng viá»‡c** | |
| Day 1-3 | UI animations, theme refinement |
| Day 4-6 | Comprehensive testing (unit, integration) |
| Day 7-9 | Battery/memory optimization |
| Day 10-12 | Documentation, README |
| Day 13-14 | Beta testing, bug fixes |
| **Káº¿t quáº£** | Production-ready app |

---

## 8. CÃ´ng Nghá»‡ & ThÆ° Viá»‡n

### Core

| Technology | Version | LÃ½ Do Chá»n |
|------------|---------|------------|
| **Kotlin** | 1.9.x | NgÃ´n ngá»¯ chÃ­nh thá»©c Android, null safety, coroutines |
| **Coroutines** | 1.7.x | Async operations trong VPN service, non-blocking I/O |
| **Flow** | (Coroutines) | Reactive streams cho state management |

### Android Jetpack

| Library | LÃ½ Do Chá»n |
|---------|------------|
| **Compose** | Modern declarative UI, less boilerplate |
| **Navigation Compose** | Type-safe navigation |
| **Room** | Robust local database, Flow support |
| **DataStore** | Modern replacement cho SharedPreferences |
| **Hilt** | Official DI solution, ViewModel integration |
| **Lifecycle** | Lifecycle-aware components |

### Monitoring & Debug

| Tool | Purpose |
|------|---------|
| **Timber** | Structured logging |
| **LeakCanary** | Memory leak detection |

### Gradle Configuration

```kotlin
// libs.versions.toml
[versions]
kotlin = "1.9.22"
compose-bom = "2024.02.00"
hilt = "2.50"
room = "2.6.1"
coroutines = "1.7.3"

[libraries]
compose-bom = { module = "androidx.compose:compose-bom", version.ref = "compose-bom" }
compose-ui = { module = "androidx.compose.ui:ui" }
compose-material3 = { module = "androidx.compose.material3:material3" }
hilt-android = { module = "com.google.dagger:hilt-android", version.ref = "hilt" }
room-runtime = { module = "androidx.room:room-runtime", version.ref = "room" }
room-ktx = { module = "androidx.room:room-ktx", version.ref = "room" }
```

---

## 9. Rá»§i Ro Ká»¹ Thuáº­t & HÆ°á»›ng Xá»­ LÃ½

### 9.1 YouTube Server-Side Ads

| Váº¥n Ä‘á» | Ads Ä‘Æ°á»£c serve tá»« `googlevideo.com`, cÃ¹ng domain vá»›i video content |
|--------|---------------------------------------------------------------------|
| **Impact** | KhÃ´ng thá»ƒ cháº·n báº±ng DNS filtering |
| **Mitigation** | TrÃ¬nh bÃ y rÃµ trong app: "YouTube ads cÃ³ thá»ƒ khÃ´ng bá»‹ cháº·n hoÃ n toÃ n" |
| **Alternative** | Suggest YouTube Premium hoáº·c browser extensions (Vanced Ä‘Ã£ shutdown) |

### 9.2 VPN Bá»‹ Kill Do Battery Optimization

| Váº¥n Ä‘á» | Android aggressive kill background services |
|--------|---------------------------------------------|
| **Impact** | VPN tá»± Ä‘á»™ng táº¯t khi thiáº¿t bá»‹ idle |
| **Solutions** | |
| | â–¸ Foreground Service vá»›i persistent notification |
| | â–¸ `startForeground()` vá»›i `FOREGROUND_SERVICE_TYPE_SPECIAL_USE` |
| | â–¸ Guide user to disable battery optimization cho app |
| | â–¸ `REQUEST_IGNORE_BATTERY_OPTIMIZATIONS` permission |

### 9.3 Giá»›i Háº¡n Play Store

| Váº¥n Ä‘á» | Google cÃ³ thá»ƒ reject apps cháº·n ads |
|--------|-------------------------------------|
| **Mitigation** | |
| | â–¸ Frame app nhÆ° "privacy protection" hoáº·c "DNS management" |
| | â–¸ Distribute qua GitHub, F-Droid |
| | â–¸ KhÃ´ng mention "block YouTube ads" trong store listing |

### 9.4 DNS-over-HTTPS (DoH) / DNS-over-TLS (DoT)

| Váº¥n Ä‘á» | Apps sá»­ dá»¥ng DoH bypass VPN DNS filtering |
|--------|-------------------------------------------|
| **Impact** | Chrome, Firefox cÃ³ built-in DoH |
| **Mitigation** | Block DoH providers (cloudflare-dns.com, dns.google) |
| **Limitation** | KhÃ´ng thá»ƒ block náº¿u app sá»­ dá»¥ng IP trá»±c tiáº¿p |

### 9.5 CÃ¡ch TrÃ¬nh BÃ y Trung Thá»±c

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TRONG BÃO CÃO / DOCUMENTATION                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  âœ“ NÃªn viáº¿t:                                                     â”‚
â”‚    "Cháº·n hiá»‡u quáº£ ads tá»« cÃ¡c domain phá»• biáº¿n nhÆ°                â”‚
â”‚     doubleclick.net, googlesyndication.com"                     â”‚
â”‚                                                                  â”‚
â”‚  âœ— KhÃ´ng nÃªn viáº¿t:                                               â”‚
â”‚    "Cháº·n 100% quáº£ng cÃ¡o YouTube"                                â”‚
â”‚    "Loáº¡i bá» hoÃ n toÃ n má»i quáº£ng cÃ¡o"                            â”‚
â”‚                                                                  â”‚
â”‚  âœ“ NÃªn cÃ³ section riÃªng:                                         â”‚
â”‚    "Limitations & Known Issues"                                 â”‚
â”‚    vá»›i giáº£i thÃ­ch ká»¹ thuáº­t táº¡i sao khÃ´ng thá»ƒ cháº·n háº¿t           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. Äá»‹nh HÆ°á»›ng Má»Ÿ Rá»™ng

### 10.1 Custom DNS

```
â–¸ Cho phÃ©p user chá»n upstream DNS server
â–¸ Preset options: Cloudflare (1.1.1.1), Google (8.8.8.8), Quad9
â–¸ Custom DNS vá»›i IP address input
â–¸ Implement DoH client cho privacy (future)
```

### 10.2 Parental Control

```
â–¸ Cháº·n ná»™i dung ngÆ°á»i lá»›n (adult content blocklist)
â–¸ Giá»›i háº¡n thá»i gian sá»­ dá»¥ng cho tá»«ng app
â–¸ PIN/password protection cho settings
â–¸ Activity monitoring cho parents
```

### 10.3 Privacy Report

```
â–¸ Tracker detection vÃ  reporting
â–¸ Weekly summary: "Apps trying to track you"
â–¸ Privacy score cho tá»«ng á»©ng dá»¥ng
â–¸ Export report as PDF
```

### 10.4 Open-Source Há»c Thuáº­t

```
â–¸ MIT License cho educational purposes
â–¸ Detailed code comments explaining networking concepts
â–¸ Architecture documentation vá»›i diagrams
â–¸ Video tutorials walkthrough codebase
```

---

## Káº¿t Luáº­n

**ShieldDNS** lÃ  má»™t dá»± Ã¡n cÃ³ giÃ¡ trá»‹ há»c thuáº­t cao, káº¿t há»£p nhiá»u khÃ­a cáº¡nh ká»¹ thuáº­t:

1. **Networking**: VPN, DNS protocol, UDP packet manipulation
2. **Android**: VpnService, Foreground Service, Battery optimization
3. **Architecture**: Clean Architecture, MVVM, Dependency Injection
4. **Modern Android**: Jetpack Compose, Flow, Coroutines

Dá»± Ã¡n phÃ¹ há»£p lÃ m:
- Äá»“ Ã¡n tá»‘t nghiá»‡p
- Portfolio showcase
- Learning project vá» Android internals

> [!NOTE]
> TÃ i liá»‡u nÃ y Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ cÃ³ thá»ƒ sá»­ dá»¥ng trá»±c tiáº¿p trong proposal Ä‘á»“ Ã¡n hoáº·c tÃ i liá»‡u thiáº¿t káº¿ há»‡ thá»‘ng.

---

*Document Version: 1.0*  
*Last Updated: 2026-02-08*
